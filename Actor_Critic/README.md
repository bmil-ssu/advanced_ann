# Pendulum Env

## 개요
Pendulum 환경 또한 OpenAI의 gym 라이브러리에서 제공하는 기본적인 환경 중 하나입니다. 본 환경에서의 제어 대상은 진자 운동을 할 수 있는 막대기 입니다.
이때, 막대기의 한쪽 끝은 고정되어 있으며, 해당 점을 축을 삼아 회전/진자 운동 할 수 있습니다. 본 환경에서의 목표는 막대기가 수직으로 세워진 상태를 유지하는 것이며, 진자의 자유단에 돌림힘을 적용함으로써 진자의 상태를 제어합니다. 
본 환경에서, 막대기는 카트 위에 존재하며, 카트를 왼쪽/오른쪽으로 밀어줌으로써 막대기가 쓰러지지 않도록 하는 것을 목표로 합니다.  
(공식 설명 링크: https://www.gymlibrary.dev/environments/classic_control/pendulum/)  
![pendulum](https://github.com/bmil-ssu/advanced_ann/assets/89993108/0451e078-4293-43ee-b4c3-1a0d7e9fde8c)

## MDP 설명
- Aim: 한쪽 끝이 고정된 진자(Pendulum)에 돌림힘을 가해 수직인 상태를 유지
- 상태 (State)
  - Pendulum state는 총 3개의 차원을 가지며 각각은 진자 자유단의 x,y 좌표 및 각속도를 나타냅니다.
    - 진자 자유단의 x 좌표 -> x = cos(theta)
      - 범위: [-1.0, 1.0]
    - 진자 자유단의 y좌표 -> y = sin(theta)
      - 범위: [-1.0, 1.0]
    - 각속도 (Angular Velocity)
      - 범위: [-8.0, 8.0]
- 행동 (Action)
  -  Pendulum 환경에서 행동 공간은 1차원이며, 연속적인 공간에서 정의됩니다.
    - 행동 의미: 진자 자유단에 가해지는 돌림힘(torque)
    - 범위: [-2, 2]
- 보상 (Reward)
  - Pendulum 환경의 보상항은 총 3개의 처벌항에 대한 선형 합으로 이루어집니다.
    - 처벌항1: theta가 0보다 클 시 즉, 수직 상태와 멀수록 높은 penalty를 부여
      $$-theta^2$$
    - 처벌항2: 이전 시점에서의 theta와 현재 theta의 차이가 클수록 높은 penalty를 부여
      $$-\Delta theta^2$$
    - 처벌항3: 진자에 적용되는 돌림힘의 크기가 클수록 높은 penalty를 부여
      $$-torque^2$$

  - 최종 보상 r은 각 처벌항에 계수가 곱해진 형태로 아래와 같이 정의합니다.
    $$r = -(theta^2 + 0.1 * theta_dt^2 + 0.001 * torque^2)$$
   
## 환경 추가 설명
- 에피소드 생성 초기 조건
  - theta는 [-pi, pi] 범위 사이 값에서 랜덤하게 설정되며, 각속도는 [-1, 1] 사이에서 랜덤하게 초기화 됩니다.
-  에피소드 종료 조건
  - 에피소드의 내 시점이 200에 도달한 경우 종료합니다.
